import matplotlib.pyplot as plt
import re

# 完整 100 轮数据（已根据您的文件内容严格校对）
epochs = list(range(100))

# 损失值 (Loss)
train_loss = [
    1.2393, 1.2904, 1.5269, 1.2132, 1.2106, 1.2377, 1.2358, 1.0997, 1.0735, 1.0869, 
    1.0914, 1.1127, 1.0663, 1.0455, 1.0662, 1.1106, 1.0784, 1.0475, 1.0233, 1.0186, 
    1.0059, 0.9986, 1.0009, 0.9950, 0.9930, 1.0052, 1.0056, 0.9998, 1.0018, 0.9950, 
    0.9846, 0.9949, 0.9938, 0.9869, 0.9957, 0.9965, 0.9904, 0.9835, 0.9705, 0.9611, 
    0.9658, 0.9626, 0.9534, 0.9536, 0.9613, 0.9423, 0.9243, 0.9114, 0.8997, 0.8864, 
    0.8650, 0.9669, 0.9203, 0.8776, 0.8841, 0.8675, 0.8396, 0.8513, 0.8286, 0.8378, 
    0.8124, 0.8123, 0.7839, 0.7882, 0.7817, 0.7726, 0.7690, 0.7785, 0.7609, 0.7771, 
    0.7628, 0.7790, 0.8236, 0.7835, 0.7748, 0.7727, 0.7654, 0.7579, 0.7593, 0.7511, 
    0.7301, 0.7440, 0.7307, 0.7237, 0.7275, 0.7122, 0.7326, 0.7258, 0.7280, 0.7210, 
    0.7365, 0.7050, 0.7178, 0.7092, 0.6915, 0.7177, 0.7120, 0.6998, 0.7144, 0.7143
]

test_loss = [
    1.1821, 1.0493, 1.0054, 1.2303, 1.0522, 1.0111, 1.2838, 1.0552, 1.0658, 1.0122, 
    1.0013, 1.1688, 1.0629, 1.1694, 1.0794, 1.1338, 1.0034, 1.0207, 1.0290, 0.9978, 
    1.0154, 1.0060, 0.9982, 1.0005, 1.0069, 1.0350, 1.0314, 1.0086, 1.0136, 1.0052, 
    0.9958, 1.0274, 1.0445, 1.0157, 0.9942, 1.0047, 1.0293, 1.0142, 1.0017, 1.0159, 
    1.0130, 0.9879, 1.0455, 1.1124, 1.0263, 1.0300, 0.9847, 1.0071, 1.0160, 0.9763, 
    1.3624, 1.2801, 1.0620, 1.2144, 1.4998, 1.7164, 0.9976, 1.1177, 1.1684, 1.5848, 
    1.1987, 1.1212, 0.9867, 1.0123, 1.2978, 1.0616, 1.0394, 1.0295, 1.1572, 1.2293, 
    1.1508, 1.5608, 1.1645, 2.4101, 1.0926, 1.1939, 1.2951, 1.0725, 1.1687, 1.0441, 
    1.0648, 1.0457, 1.1057, 1.2027, 1.1107, 1.0825, 1.1626, 1.1237, 1.1627, 1.4206, 
    1.2318, 1.1646, 1.1505, 1.3157, 1.2170, 1.1397, 1.1102, 1.2321, 1.2110, 1.1711
]

# 准确率 (Accuracy)
train_acc = [
    0.5410, 0.5330, 0.5426, 0.5378, 0.4653, 0.5410, 0.5346, 0.5281, 0.5458, 0.5330, 
    0.4750, 0.5314, 0.4702, 0.5426, 0.5330, 0.5346, 0.4975, 0.4959, 0.5314, 0.5120, 
    0.5281, 0.5475, 0.4798, 0.4798, 0.4734, 0.5442, 0.5394, 0.5491, 0.5346, 0.5201, 
    0.5442, 0.5539, 0.5185, 0.4959, 0.4653, 0.4685, 0.4669, 0.5040, 0.5780, 0.4669, 
    0.6280, 0.5169, 0.4669, 0.4669, 0.4702, 0.4669, 0.5571, 0.4879, 0.5072, 0.6537, 
    0.4669, 0.4685, 0.5362, 0.4685, 0.5426, 0.4669, 0.7133, 0.6972, 0.5603, 0.5410, 
    0.6876, 0.7069, 0.7761, 0.7648, 0.6634, 0.7842, 0.7697, 0.7423, 0.7665, 0.6119, 
    0.6763, 0.5024, 0.6618, 0.5458, 0.7037, 0.5378, 0.6392, 0.7697, 0.7359, 0.8051, 
    0.7004, 0.7971, 0.7697, 0.7455, 0.8228, 0.7520, 0.7230, 0.7922, 0.6988, 0.6988, 
    0.7359, 0.6586, 0.7455, 0.7439, 0.8196, 0.8196, 0.8003, 0.8115, 0.8067, 0.7906
]

test_acc = [
    0.4879, 0.4927, 0.4734, 0.5024, 0.4927, 0.5072, 0.4830, 0.4927, 0.4927, 0.4927, 
    0.5169, 0.4734, 0.5410, 0.4975, 0.4927, 0.4734, 0.4734, 0.4734, 0.4782, 0.5024, 
    0.4927, 0.4782, 0.5024, 0.5072, 0.5072, 0.4637, 0.4734, 0.4734, 0.4734, 0.4879, 
    0.4975, 0.4685, 0.4830, 0.4927, 0.5024, 0.5072, 0.5072, 0.5024, 0.4879, 0.5072, 
    0.5120, 0.5314, 0.5072, 0.5024, 0.5024, 0.5024, 0.5410, 0.5120, 0.5120, 0.5458, 
    0.5024, 0.5024, 0.5314, 0.5072, 0.4927, 0.5072, 0.5603, 0.5652, 0.5024, 0.4927, 
    0.5507, 0.5700, 0.5652, 0.5507, 0.5555, 0.5748, 0.5410, 0.5555, 0.5507, 0.5265, 
    0.5169, 0.5410, 0.5507, 0.4927, 0.5845, 0.5314, 0.5362, 0.5797, 0.5700, 0.5652, 
    0.5603, 0.5700, 0.5362, 0.5458, 0.5893, 0.5603, 0.5458, 0.5652, 0.5845, 0.5603, 
    0.5458, 0.5410, 0.5507, 0.5458, 0.5748, 0.6038, 0.6086, 0.5700, 0.5748, 0.5893
]

# 设置图表风格
plt.rcParams['font.sans-serif']=['SimHei'] # 解决中文显示
plt.rcParams['axes.unicode_minus']=False
plt.style.use('ggplot')

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))

# --- 绘制 Loss 曲线 ---
ax1.plot(epochs, train_loss, label='训练集损失 (Train Loss)', color='#1f77b4', linewidth=2)
ax1.plot(epochs, test_loss, label='测试集损失 (Test Loss)', color='#ff7f0e', linestyle='--', alpha=0.8)
ax1.set_title('BrainGNN 损失函数学习曲线', fontsize=14)
ax1.set_xlabel('训练轮次 (Epoch)', fontsize=12)
ax1.set_ylabel('损失值 (Loss)', fontsize=12)
ax1.legend()
ax1.grid(True)

# --- 绘制 Accuracy 曲线 ---
ax2.plot(epochs, train_acc, label='训练集准确率 (Train Acc)', color='#2ca02c', linewidth=2)
ax2.plot(epochs, test_acc, label='测试集准确率 (Test Acc)', color='#d62728', linestyle='--', alpha=0.8)
ax2.set_title('BrainGNN 分类准确率曲线', fontsize=14)
ax2.set_xlabel('训练轮次 (Epoch)', fontsize=12)
ax2.set_ylabel('准确率 (Accuracy)', fontsize=12)
ax2.legend(loc='lower right')
ax2.grid(True)

plt.tight_layout()
# 如需保存图片，取消下面一行的注释
# plt.savefig('braingnn_100epochs_results.png', dpi=300)
plt.show()